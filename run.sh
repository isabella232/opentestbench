#    Opentestbench : an open-source framework to assess the performances of image compression schemes
#    Copyright (C) 2015  Universite Catholique de Louvain, Alexandre Willème
#
#    Opentestbench is free software: you can redistribute it and/or modify
#    it under the terms of the GNU General Public License as published by
#    the Free Software Foundation, either version 3 of the License, or
#    (at your option) any later version.
#
#    This program is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU General Public License for more details.
#
#    You should have received a copy of the GNU General Public License
#    along with this program.  If not, see <http://www.gnu.org/licenses/>.
#    
#   For any question please contact : 
#   Alexandre Willème (alexandre.willeme@uclouvain.be)
#   Sébastien Lugan (sebastien.lugan@uclouvain.be)


#!/bin/bash
export LANG=C

# either singlegen multigen or errortest
test_type=singlegen
#codecs=(j2kull j2kullc vc2hqcbr vc2ld)
codecs=(j2kull)
bitrates=(3 4 5 6 7 8 9 10 12 15 24)
#bitrates=(6)
#content_dirs=(/export/image_content/screen_content_db/compressed \
#							/export/image_content/screen_content_db/earthpictures \
#							/export/image_content/screen_content_db/map \
#							/export/image_content/screen_content_db/miscanelous \
#							/export/image_content/screen_content_db/modifiedcompressed \
#							/export/image_content/screen_content_db/streaming \
#							/export/image_content/screen_content_db/text \
#							/export/image_content/screen_content_db/uncompressed) 
#content_dirs=(/export/image_content/ebu/ebuv210/Lupo_candlelight_one)
#content_dirs=(/export/image_content/screen_content_db/uncompressedtwo)
#content_dirs=(/export/image_content/ebu/ebuv210/Lupo_candlelight_two)

content_dirs=(/export/image_content/ebu/ebuv210/candle_smoke_reduce \
/export/image_content/ebu/ebuv210/fountain_lady_reduce \
/export/image_content/ebu/ebuv210/Lupo_boa_reduce \
/export/image_content/ebu/ebuv210/Lupo_candlelight_reduce \
/export/image_content/ebu/ebuv210/Lupo_confetti_reduce \
/export/image_content/ebu/ebuv210/park_dancers_reduce \
/export/image_content/ebu/ebuv210/pendulus_wide_reduce \
/export/image_content/ebu/ebuv210/rain_fruits_reduce \
/export/image_content/ebu/ebuv210/studio_dancer_reduce \
/export/image_content/ebu/ebuv210/veggie_fruits_reduce \
/export/image_content/ebu/ebuv210/waterfall_pan_reduce \
/export/image_content/ebu/ebuv210/wind_wool_reduce \
/export/image_content/ebu/ebutiff/candle_smoke_reduce \
/export/image_content/ebu/ebutiff/fountain_lady_reduce \
/export/image_content/ebu/ebutiff/Lupo_boa_reduce \
/export/image_content/ebu/ebutiff/Lupo_candlelight_reduce \
/export/image_content/ebu/ebutiff/Lupo_confetti_reduce \
/export/image_content/ebu/ebutiff/park_dancers_reduce \
/export/image_content/ebu/ebutiff/pendulus_wide_reduce \
/export/image_content/ebu/ebutiff/rain_fruits_reduce \
/export/image_content/ebu/ebutiff/veggie_fruits_reduce \
/export/image_content/ebu/ebutiff/studio_dancer_reduce \
/export/image_content/ebu/ebutiff/waterfall_pan_reduce \
/export/image_content/ebu/ebutiff/wind_wool_reduce)

# either RGB or YCbCr
color_spaces=(YCbCr YCbCr YCbCr YCbCr YCbCr YCbCr YCbCr YCbCr YCbCr YCbCr YCbCr YCbCr RGB RGB RGB RGB RGB RGB RGB RGB RGB RGB RGB RGB)
#color_spaces=(RGB)
#color_spaces=(YCbCr)
# either 444 or 422
chroma_subs=(422 422 422 422 422 422 422 422 422 422 422 422 444 444 444 444 444 444 444 444 444 444 444 444)
#chroma_subs=(444)
#chroma_subs=(422)
# either 8 or 10 bits
bit_depths=(10 10 10 10 10 10 10 10 10 10 10 10 8 8 8 8 8 8 8 8 8 8 8 8)
#bit_depths=(8)
#bit_depths=(10)
# WIDTHxHEIGHT
image_sizes=(3840x2160 3840x2160 3840x2160 3840x2160 3840x2160 3840x2160 3840x2160 3840x2160 3840x2160 3840x2160 3840x2160 3840x2160 3840x2160 3840x2160 3840x2160 3840x2160 3840x2160 3840x2160 3840x2160 3840x2160 3840x2160 3840x2160 3840x2160 3840x2160)
# only used for multigen
niter=10
comparison_with_original=1
# only used for error
nerrors=5


#-----------------------------------------------------------------------------

source benchmark/paths.sh

for ((a=0; a<${#codecs[@]}; ++a)); do
    for ((b=0; b<${#content_dirs[@]}; ++b)); do
        for ((c=0; c<${#bitrates[@]}; ++c)); do
					if [ ${test_type} = "singlegen" ]; then
						bash benchmark/singlegen.sh ${codecs[$a]} ${bitrates[$c]} ${content_dirs[$b]} ${color_spaces[$b]} ${chroma_subs[$b]} ${bit_depths[$b]} ${image_sizes[$b]}
					elif [ ${test_type} = "multigen" ]; then 
						bash benchmark/multigen.sh ${codecs[$a]} ${bitrates[$c]} ${content_dirs[$b]} ${color_spaces[$b]} ${chroma_subs[$b]} ${bit_depths[$b]} ${image_sizes[$b]} ${niter} ${comparison_with_original}
					elif [ ${test_type} = "errortest" ]; then 
						bash benchmark/errortest.sh ${codecs[$a]} ${bitrates[$c]} ${content_dirs[$b]} ${color_spaces[$b]} ${chroma_subs[$b]} ${bit_depths[$b]} ${image_sizes[$b]} ${nerrors}
					else
						echo This test type does not exist
					fi
        done
    done
done 
